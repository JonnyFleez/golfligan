<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rapportera â€“ GolfLigan</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <style>
    body { background: #f8f9fa; }
    .card { border-radius: 20px; max-width: 500px; margin: 0 auto; }
    .btn-outline-success, .btn-outline-danger { 
      width: 60px; 
      height: 60px; 
      font-size: 1.8rem; 
      display: flex; 
      align-items: center; 
      justify-content: center;
    }
    #beerValueDisplay { 
      min-width: 70px; 
      text-align: center; 
      font-size: 2.2rem; 
      font-weight: 600;
    }
    #beerInfo { 
      font-size: 1.2rem; 
      margin-top: 15px; 
      text-align: center;
    }
    #beerEmoji { 
      font-size: 2.5rem; 
      margin-right: 12px;
    }
    .form-select { 
      font-size: 1.2rem; 
      padding: 12px;
    }
    .fw-bold { font-weight: 600; }
    .text-success { color: #1a5d1a !important; }
  </style>
</head>
<body>
  <div class="container my-4">
    <div class="card shadow-sm p-4">

      <!-- Header -->
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="fw-bold mb-0"><%= playerName %></h2>
        <a href="/" class="btn btn-secondary">Huvudmeny</a>
      </div>

      <!-- Speldag info -->
      <p class="text-success fs-5 fw-semibold mb-0"><%= gameDay.date %> â€“ <%= gameDay.gameMode || gameDay.type %></p>
      <p class="text-secondary mb-3">Tee: <%= gameDay.tee %></p>

      <% if (sidePlacement) { %>
        <p class="text-info mb-3 fw-semibold">Sidospel placering: <%= sidePlacement %></p>
      <% } %>

      <hr>

      <!-- FormulÃ¤r -->
      <form action="/game-day/<%= gameDay.id %>/report" method="POST">

        <!-- Placering -->
        <label class="fw-semibold mb-1 d-block">Placering i huvudtÃ¤vling</label>
        <select name="placement" class="form-select mb-4" required>
          <% for (let i = 1; i <= playerCount; i++) { %>
            <option value="<%= i %>" <%= placement == i ? 'selected' : '' %>><%= i %></option>
          <% } %>
        </select>

        <!-- Beergame -->
        <label class="fw-semibold mb-1 d-block">Beergame (netto poletter)</label>
        <div class="d-flex align-items-center gap-3 mb-3 justify-content-center">
          <button type="button" id="beerMinus" class="btn btn-outline-danger fw-bold">âˆ’</button>
          <span id="beerValueDisplay" class="fw-bold">0</span>
          <button type="button" id="beerPlus" class="btn btn-outline-success fw-bold">+</button>
        </div>

        <!-- Dolda fÃ¤lt -->
        <input type="hidden" id="beerSign" name="beerSign" value="+">
        <input type="hidden" id="beerCount" name="beerCount" value="0">

        <!-- Feedback med emojis -->
        <div id="beerInfo" class="d-flex align-items-center justify-content-center">
          <span id="beerEmoji"></span>
          <span id="beerText" class="fw-semibold"></span>
        </div>

        <!-- Submit -->
        <button type="submit" class="btn btn-success w-100 mt-4 py-3 fw-bold fs-5">
          Skicka in resultat
        </button>
      </form>
    </div>
  </div>

<script>
  let beerValue = <%= beerCount %> * (<%= beerSign === '-' ? -1 : 1 %>);

  const minusBtn = document.getElementById("beerMinus");
  const plusBtn = document.getElementById("beerPlus");
  const beerSignInput = document.getElementById("beerSign");
  const beerCountInput = document.getElementById("beerCount");
  const beerValueDisplay = document.getElementById("beerValueDisplay");
  const beerEmoji = document.getElementById("beerEmoji");
  const beerText = document.getElementById("beerText");

  function updateBeerDisplay() {
    // BegrÃ¤nsa -9 till +9
    if (beerValue > 9) beerValue = 9;
    if (beerValue < -9) beerValue = -9;

    // Uppdatera dolda fÃ¤lt
    beerSignInput.value = beerValue >= 0 ? "+" : "-";
    beerCountInput.value = Math.abs(beerValue);

    // Visa vÃ¤rde
    beerValueDisplay.textContent = beerValue === 0 ? '0' : (beerValue > 0 ? `+${beerValue}` : beerValue);

    // Riktiga emojis
    if (beerValue > 0) {
      beerEmoji.textContent = "ðŸ˜Š"; // Positiva poletter
      beerText.textContent = `${beerValue} positiva poletter`;
    } else if (beerValue < 0) {
      beerEmoji.textContent = "ðŸ˜¡"; // Negativa poletter
      beerText.textContent = `${Math.abs(beerValue)} negativa poletter`;
    } else {
      beerEmoji.textContent = "ðŸ˜"; // Neutral
      beerText.textContent = `0 poletter`;
    }
  }

  minusBtn.addEventListener("click", () => {
    beerValue--;
    updateBeerDisplay();
  });

  plusBtn.addEventListener("click", () => {
    beerValue++;
    updateBeerDisplay();
  });

  // KÃ¶r vid start
  updateBeerDisplay();
</script>
</body>
</html>